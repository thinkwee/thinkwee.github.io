---
title: Seq2seq based Summarization
date: 2018-07-04 15:58:59
tags:
  - abstractive summarization
  - seq2seq
  - machine learning
  - rnn
  - nlp
  - lstm
  - gru
categories:
  - NLP
mathjax: true
html: true
---

<img src="https://i.mji.rip/2025/07/16/2f67b4f7fae34b1e08aa1c7cc17df6b8.png" width="500"/>

A bachelor's graduation project involves developing a short sentence summarization model based on seq2seq and designing an emotional fusion mechanism. Now, let's provide a brief summary of the entire model

<!--more-->

![i0TGHH.png](https://s1.ax1x.com/2018/10/20/i0TGHH.png)

{% language_switch %}

{% lang_content en %}

Task
====

*   Automatic text summarization is a type of natural language processing (NLP) task. For a longer text, it generates a short text that covers the core meaning of the original text, which is the summary of the original text. Automatic summarization technology refers to constructing mathematical models on computers, inputting long texts into the model, and then automatically generating short summaries through computation. According to the scale of the corpus needed for generating summaries and the scale of the summaries, summaries can be divided into multi-document summaries, long document summaries, and short document summaries. This paper mainly studies short document summarization: for a sentence or a few sentences of text, generate a short summary that summarizes the key information of the original text, and is fluent and readable, trying to reach the level of summaries written by human authors.
*   Automatic text summarization is divided into extraction-based and generation-based methods, the former being the extraction of original sentences to form the summary, and the latter being the generation of the summary through a deep learning model, character by character. This paper mainly focuses on the generation of summaries and abstracts the problem into generating a short sentence of an average length of 8 words from a long sentence with an average length of 28 words.

![i0TYEd.jpg](https://s1.ax1x.com/2018/10/20/i0TYEd.jpg)

Preparatory Knowledge
=====================

Recurrent Neural Network
------------------------

*   Recurrent Neural Network (RNN), a variant of neural networks, is capable of effectively processing sequential data. All its hidden layers share parameters, with each hidden layer not only depending on the current moment's input but also on the state of the previous hidden layer. The data flow is not propagated between network layers as in traditional neural networks, but rather circulates as a state within its own network.
*   ![i0TtUA.jpg](https://s1.ax1x.com/2018/10/20/i0TtUA.jpg)
*   After time step expansion: ![i0TN4I.jpg](https://s1.ax1x.com/2018/10/20/i0TN4I.jpg) 

LSTM and GRU
------------

*   Recurrent neural networks can effectively capture the sequential information of sequence data and can construct very deep neural networks without generating a large number of parameters to be learned; however, due to parameter sharing, when gradients are chain-derived through time steps, it is equivalent to matrix power operations. If the eigenvalues of the parameter matrix are too small, it will cause gradient diffusion, and if the eigenvalues are too large, it will cause gradient explosion, affecting the backpropagation process, i.e., the long-term dependency problem of RNNs. When dealing with long sequence data, the long-term dependency problem can lead to the loss of long-term memory information in the sequence. Although people have tried to alleviate this problem by introducing gradient truncation and skip connection techniques, the effect is not significant until the long short-term memory neural networks and gated recurrent neural networks, as extended forms of RNNs, effectively solve this problem.
    
*   LSTM stands for Long Short-Term Memory, a type of neural network that introduces gate units in its nodes to capture long-term memory information. These gate units, as part of the network parameters, participate in training and control the extent to which the current hidden layer node memory (forgetting) past information and accepts new memory input. ![i0TaCt.jpg](https://s1.ax1x.com/2018/10/20/i0TaCt.jpg) 
    
*   GRU stands for Gated Recurrent Unit, which differs from LSTM in that GRU integrates the forget gate and input gate into a reset gate, with the control values of the forget gate and input gate summing to 1. Therefore, GRU simplifies the parameters on the basis of LSTM, allowing the model to converge faster. ![i0Td8P.jpg](https://s1.ax1x.com/2018/10/20/i0Td8P.jpg) 
    
    Word Embedding
    --------------
    
*   One of the major advantages of deep learning is its ability to automatically learn features. In natural language processing, we specifically use techniques like word2vec to learn the feature representations of words, i.e., word embeddings.
    
*   Word vectors, also known as word embeddings, represent words in the form of continuous value vectors (Distributed Representation), rather than using a discrete method (One-hot Representation). In traditional discrete representation, a word is represented by a vector of length V, where V is the size of the dictionary. Only one element in the vector is 1, with the rest being 0, and the position of the 1 indicates the word's index in the dictionary. Storing words in a discrete manner is inefficient, and the vectors cannot reflect the semantic and grammatical features of words, whereas word vectors can address these issues. Word vectors reduce the dimension of the vector from V to $\sqrt[k] V$ (usually k takes 4), with the values of each element no longer being 1 and 0, but continuous values. Word vectors are a byproduct of supervised learning obtained from the Neural Network Language Model (NNLM) for corpus, and the proposal of this model is based on a linguistic assumption: words with similar semantics have similar contexts, that is, the NNLM model can determine the corresponding central word under the given context.
    
*   The figure below illustrates the skipgram model in word2vec: ![i0Twgf.jpg](https://s1.ax1x.com/2018/10/20/i0Twgf.jpg) 
    
*   The obtained word embedding matrix is as follows: ![i0T0v8.jpg](https://s1.ax1x.com/2018/10/20/i0T0v8.jpg) 
    
*   Mikolov et al. proposed the Word2Vec model based on NNLM, where the input and output for supervised learning are respectively the center word and its context (i.e., the Skip Gram model) or the context and the center word (i.e., the CBOW model). Both methods can effectively train high-quality word vectors, but the CBOW model calculates the center word based on the context, has a fast training speed, and is suitable for training on large corpora; the Skip Gram model can fully utilize the training corpus, and its meaning is "jumping grammar model." It not only uses adjacent words to form the context of the center word but also uses words that are one word apart as part of the context. As shown in Figure 2-1, the context of a center word in the corpus includes four words. If there are Wtotal words in the corpus, the Skip Gram model can calculate 4 Â· Wtotal times of loss and perform backpropagation learning, which is four times the number of learning times for the corpus compared to the CBOW model, so this model is suitable for fully utilizing small corpora to train word vectors.
    
*   Word2Vec model training is completed, and the weight matrix between the input layer and the hidden layer is the Word Embedding Matrix. Multiplying the vector representing the discrete word with the matrix yields the word vector, which is actually equivalent to looking up the corresponding word vector (Embedding Look Up) in the word embedding matrix. Word vectors can effectively represent the semantic relationships between words, essentially providing a method for machine learning models to extract text information features, facilitating the numerical input of words into the model for processing. Traditional language model training of word vectors incurs too much overhead in the output Softmax layer.
    
*   The Word2Vec model employs both Hierarchical Softmax and Noise Contrastive Estimation techniques, significantly accelerating the training process, making it possible to train high-quality word vectors with large-scale corpus in natural language processing.
    

Attention
---------

*   In NLP tasks, the attention mechanism was first applied to machine translation, where a weight matrix is introduced to represent the contribution degree of each element in the encoder sequence to each word generated by the decoder. In practical implementation, the attention mechanism generates an attention weight, which performs attention-weighted generation of intermediate representations for the hidden layer states of various encoder elements, rather than simply using the hidden layer state of the last element. The simplest attention is the decoder's attention to the encoder, which is divided into global and local attention. Global attention generates attention weights for the entire encoder sequence, while local attention first trains an attention alignment position and then takes a window around this position, weighting only the sequence within the window, making the attention more precise and focused. One byproduct of the attention mechanism is the alignment between words (Alignment). In machine translation, the alignment relationship can be understood as the degree of association between words and their translations. In automatic summarization, the application of the attention mechanism can effectively alleviate the problem of information loss when long sequences are encoded into intermediate representations by the encoder. ![i0TDKS.jpg](https://s1.ax1x.com/2018/10/20/i0TDKS.jpg) 

Sequence to sequence
--------------------

*   seq2seq model, which uses an RNN as an encoder to encode the input sequence data into intermediate semantic representation, and then utilizes another RNN as a decoder to obtain the serialized output from the intermediate semantic representation. Generalized sequence-to-sequence and end-to-end learning may not necessarily use RNNs; CNNs or pure attention mechanisms can also be used. ![i0TrDg.jpg](https://s1.ax1x.com/2018/10/20/i0TrDg.jpg) 
*   Some personal understanding of sequence-to-sequence models:
    *   (Information Theory) If the specific implementation forms of the encoder and decoder are not considered, and it is only assumed that the encoder can convert sequence data into an intermediate representation, and the decoder can convert the intermediate representation back into sequence data, then the entire sequence-to-sequence model is equivalent to one round of encoding and decoding of abstract information. Since the dimension of the intermediate representation is much smaller than the total dimension of the encoder, this encoding is lossy. The sequence-to-sequence model aims to make the result of the lossy encoding extract the abstract information from the original text, so the goal of training the network is to let the loss part be the redundant information that is not needed in the abstract. The decoder is equivalent to the inverse process of the encoder, restoring the abstract sequence data from the intermediate representation that contains the abstract information.
    *   (Study and Application) If the entire model is likened to the human brain, then the encoder's hidden layer states are equivalent to the knowledge stored within the brain, while the decoder utilizes this knowledge to solve problems, that is, the encoder is a learning process and the decoder is an application process. This analogy can vividly explain various subsequent improvements to the sequence-to-sequence model: learning at time steps corresponds to learning on the real timeline, with earlier learned knowledge being more easily forgotten in the brain (hidden layer information from earlier time steps is severely lost by the final step), and the brain's capacity being finite (the information storage capacity of the intermediate representation is fixed). Therefore, during learning, we selectively remember and forget information (application of LSTM and GRU), and even highlight key points in the process of memorization (attention mechanism), and can also rely on querying information from the external environment to solve problems without entirely depending on one's own memory (memory networks).
    *   (Circular Recurrent Neural Network) From the perspective of data flow and network structure, the entire sequence-to-sequence model can be regarded as a long RNN with certain time steps limited for input and output, as illustrated in Figure 3-1, the model is an RNN with 8 time steps, where the first 5 time steps have no output, and the last 3 time steps pass the output to the next time step to guide state changes. Joint training of the encoder and decoder is equivalent to training this large RNN. This RNN, which only performs input and output at some nodes, is structurally suitable for handling sequence-to-sequence tasks.

Sequence Loss
-------------

*   The decoder outputs the probability distribution of the dictionary at each step, selecting the word with the highest probability (or performing ææç´¢), with the loss being the cross-entropy between the probability at each step and the 01 distribution of the standard word, summed and averaged. In practice, a mask is also applied to address the issue of varying sentence lengths.

Basic Model
===========

*   Preprocessing: For the application of sequence-to-sequence models, certain preprocessing of the data is required, in addition to the commonly used stop word removal and UNK replacement, as well as padding. It also requires the design of start and end symbols for decoding, as follows: ![i0TsbQ.jpg](https://s1.ax1x.com/2018/10/20/i0TsbQ.jpg) 
*   After training word embeddings, perform an embedding lookup operation on the input to obtain features ![i0T6Ej.jpg](https://s1.ax1x.com/2018/10/20/i0T6Ej.jpg) 
*   Feature input encoder receives intermediate representation ![i0Tg5n.png](https://s1.ax1x.com/2018/10/20/i0Tg5n.png) 
*   Obtain the intermediate representation and output the abstract (equivalent to label), input the decoder for decoding ![i0TIrF.png](https://s1.ax1x.com/2018/10/20/i0TIrF.png) 
*   The complete sequence-to-sequence model structure after incorporating the attention mechanism is as follows: ![i0TRCq.jpg](https://s1.ax1x.com/2018/10/20/i0TRCq.jpg) 

Emotional fusion mechanism
==========================

*   The emotional mechanism primarily supplements the emotional features of text, manually constructing a six-dimensional feature through the search of an emotional dictionary, and it is hoped in the future to carry out this work by automatically constructing features.
*   Firstly, train an emotion classifier, filter the original corpus to form an emotional corpus, and test the model on both the emotional corpus and the general corpus ![i0TW80.jpg](https://s1.ax1x.com/2018/10/20/i0TW80.jpg) 
*   Obtain sentiment vectors (i.e., sentiment features) from a dictionary ![i0Tf2V.jpg](https://s1.ax1x.com/2018/10/20/i0Tf2V.jpg) 
*   Directly concatenate the emotional features after the intermediate representation, input decoder ![i0ThvT.jpg](https://s1.ax1x.com/2018/10/20/i0ThvT.jpg) 

Results
=======

*   Results are recorded in the form of ROUGE-F1 values, a comparison of various methods under sentiment corpus ![i0T5KU.png](https://s1.ax1x.com/2018/10/20/i0T5KU.png) 
*   Comparative Study of Sentiment Fusion Schemes under Common Corpus ![i0Tb5R.png](https://s1.ax1x.com/2018/10/20/i0Tb5R.png) 
*   Emotional classification accuracy, as a reference, the previously trained emotional classifier accuracy was 74% ![i0Tob4.png](https://s1.ax1x.com/2018/10/20/i0Tob4.png) 
*   Because it is large corpus with small batch training, only ten iterations were trained, and the effect of the test set in each iteration is ![i0T7VJ.png](https://s1.ax1x.com/2018/10/20/i0T7VJ.png) 

Problem
=======

*   Problem of unknown replacement: Many literature mentions the use of pointer switch technology to solve the rare words (unk) in generated abstracts, that is, selecting words from the original text to replace the unk in the abstract. However, since ROUGE evaluates the co-occurrence degree of words, even if the words from the original text are replaced, regardless of the position or word accuracy, it may result in an increase in ROUGE value, causing the evaluation results to be overestimated. This paper designs comparative experiments and finds that even random replacements without any mechanism can improve the ROUGE value
*   Corpus Repetition Issue: During the examination of the corpus, we found a large number of short texts that are different but have the same abstracts. The repeated corpus comes from different descriptions of the same event or some functional text, such as "...... Wednesday...... Gold prices rose" and "...... Thursday...... Gold prices rose" both generating the same abstract "Gold prices rose." The repetition of short abstracts can cause the model to learn some phrases that should not be solidified at the decoding end. Moreover, if there are repeated identical abstracts in the training set and test set, the solidified abstracts can lead to an artificially high accuracy of generated abstracts. For such texts, this paper conducted four groups of experiments:
    *   Without deduplication: Retain the original text, do not deduplicate, and perform training and testing
    *   De-duplication: Remove all short texts corresponding to duplicate abstracts from the corpus.
    *   Training De-duplication: Partial de-duplication, only removing duplicate data from the training corpus, meaning that the well-trained model is not affected by duplicate text.
    *   Test deduplication: Partial deduplication, only removing the parts of the test set that are duplicated in the training set. Good learning models were affected by duplicate texts, but there was no corresponding data in the test set for the duplicate texts. Under duplicate corpus training, both ROUGE-1 and ROUGE-L exceeded 30, far beyond the normal training models, and after deduplication, they returned to normal levels. The results of the two partial deduplication methods indicate: when training deduplication, models not affected by duplicate corpus did not show significant reactions to the duplicate data in the test set, approximating the normal models with complete deduplication; when testing deduplication, although the model was affected by duplicate corpus, there was no duplicate data in the test set for the model to utilize the learned fixed abstracts, so the results would not be overly high. Moreover, due to learning the pattern of the same abstract corresponding to different short texts, the encoding end actually has a more flexible structure, leading to ROUGE scores higher than those of training deduplication. ![i0TLP1.png](https://s1.ax1x.com/2018/10/20/i0TLP1.png) 

Environmental Implementation
============================

*   Here is the GitHub address: - Abstract\_Summarization\_Tensorflow
*   Ubuntu 16.04
*   Tensorflow 1.6
*   CUDA 9.0
*   Cudnn 7.1.2
*   Gigawords dataset, trained on part of the data, approximately 300,000
*   GTX1066, training time 3 to 4 hours

References
==========

![i0TX26.jpg](https://s1.ax1x.com/2018/10/20/i0TX26.jpg)
![i0TO8x.jpg](https://s1.ax1x.com/2018/10/20/i0TO8x.jpg)

{% endlang_content %}

{% lang_content zh %}

# ä»»å¡

- èªå¨æææ¯ä¸ç±»èªç¶è¯­è¨å¤çï¼Natural Language Processinï¼NLPï¼ä»»å¡ãå¯¹äºä¸æ®µè¾é¿çææ¬ï¼äº§çä¸æ®µè½å¤è¦çåææ ¸å¿æä¹çç­ææ¬ï¼è¿æ®µç­ææ¬å°±æ¯åææ¬çæè¦ãèªå¨ææææ¯æ¯æå¨è®¡ç®æºä¸æå»ºæ°å­¦æ¨¡åï¼å°é¿ææ¬è¾å¥æ¨¡åï¼éè¿è®¡ç®ä¹åæ¨¡åè½èªå¨çæç­æè¦ãæ ¹æ®éè¦äº§çæè¦çè¯­æè§æ¨¡åæè¦çè§æ¨¡ï¼å¯ä»¥å°æè¦åä¸ºå¤ææ¬æè¦ãé¿ææè¦ãç­ææè¦ãæ¬æä¸»è¦ç ç©¶çæ¯ç­ææè¦ï¼å¯¹äºä¸å¥æèå å¥ææ¬ï¼çæä¸å¥ç­æè¦ï¼æ¦æ¬åæå³é®ä¿¡æ¯ï¼ä¸æµçå¯è¯»ï¼å°½éè¾¾å°äººç±»ä½èæ°åæè¦çæ°´å¹³ã
- èªå¨ææåæ½åå¼åçæå¼ï¼åèæ¯æ½ååæå¥å­ææææï¼åèæ¯éè¿æ·±åº¦å­¦ä¹ æ¨¡åéå­çæææãæ¬æä¸»è¦ç ç©¶çæææï¼å¹¶å°é®é¢æ½è±¡æå¯¹ä¸ä¸ªå¹³åé¿åº¦ä¸º28è¯çé¿å¥çæä¸ä¸ªå¹³åé¿åº¦ä¸º8è¯çç­å¥ã

![i0TYEd.jpg](https://s1.ax1x.com/2018/10/20/i0TYEd.jpg)

# é¢å¤ç¥è¯

## å¾ªç¯ç¥ç»ç½ç»

- å¾ªç¯ç¥ç»ç½ç»ï¼Recurrent Neural Networkï¼RNNï¼ï¼æ¯ç¥ç»ç½ç»çä¸ç§åå½¢ï¼è½å¤ææå¤çåºååæ°æ®ï¼å¶ææçéèå±å±äº«åæ°ï¼æ¯ä¸éèå±ä¸ä»ä¾èµå½åæ¶å»çè¾å¥è¿ä¾èµä¸ä¸æ¶å»çéèå±ç¶æï¼æ°æ®æµå¹¶ä¸æ¯å¦ä¼ ç»ç¥ç»ç½ç»é£æ ·å¨ç½ç»å±ä¹é´ä¼ æ­ï¼èæ¯ä½ä¸ºç¶æå¨èªèº«ç½ç»ä¸­å¾ªç¯ä¼ éã
- ä¸å±å¼æ¶å½¢å¼å¦ä¸ï¼
  ![i0TtUA.jpg](https://s1.ax1x.com/2018/10/20/i0TtUA.jpg)
- ææ¶é´æ­¥å±å¼ä¹åï¼
  ![i0TN4I.jpg](https://s1.ax1x.com/2018/10/20/i0TN4I.jpg)

## LSTMåGRU

- å¾ªç¯ç¥ç»ç½ç»è½å¤ææææåºåæ°æ®çé¡ºåºä¿¡æ¯ä¸è½å¤æé å¾æ·±çç¥ç»ç½ç»èä¸äº§çå¤§ééè¦å­¦ä¹ çåæ°ï¼ä½ä¹å ä¸ºåæ°å±äº«ï¼æ¢¯åº¦éè¿æ¶é´æ­¥è¿è¡é¾å¼æ±å¯¼æ¶ç¸å½äºè¿è¡ç©éµå¹è¿ç®ï¼è¥åæ°ç©éµçç¹å¾å¼è¿å°ä¼é ææ¢¯åº¦å¼¥æ£ï¼ç¹å¾å¼è¿å¤§ä¼é ææ¢¯åº¦çç¸ï¼å½±åååä¼ æ­è¿ç¨ï¼å³RNNçé¿æä¾èµé®é¢ãå¨å¤çé¿åºåæ°æ®æ¶é¿æä¾èµé®é¢ä¼å¯¼è´åºåçé¿æè®°å¿ä¿¡æ¯ä¸¢å¤±ï¼è½ç¶äººä»¬éè¿å¼å¥æ¢¯åº¦æªæ­åè·³è·é¾æ¥ææ¯è¯å¾ç¼è§£æ­¤é®é¢ï¼ä½ææå¹¶ä¸æ¾èï¼ç´å°é¿ç­æè®°å¿ç¥ç»ç½ç»åé¨æ§å¾ªç¯ç¥ç»ç½ç»ä½ä¸º RNN çæ©å±å½¢å¼çåºç°ï¼ææå°è§£å³äºè¿ä¸ªé®é¢ã
- LSTMå³é¿ç­æè®°å¿ç¥ç»ç½ç»ãä¸ºäºææé¿æè®°å¿ä¿¡æ¯ï¼LSTMå¨å¶èç¹ä¸­å¼å¥äºé¨æ§ååï¼ä½ä¸ºç½ç»åæ°çä¸é¨ååä¸è®­ç»ãé¨æ§ååæ§å¶äºå½åéèå±èç¹è®°å¿ï¼éå¿ï¼è¿å»ä¿¡æ¯ï¼æ¥åå½åè¾å¥æ°è®°å¿çç¨åº¦ã
  ![i0TaCt.jpg](https://s1.ax1x.com/2018/10/20/i0TaCt.jpg)
- GRUå³é¨æ§ç¥ç»ç½ç»ï¼ä¸LSTMä¸åçæ¯ï¼GRU å°éå¿é¨åè¾å¥é¨æ´åä¸ºéç½®é¨ï¼éå¿é¨çé¨æ§å¼åè¾å¥é¨çé¨æ§å¼åä¸º 1ï¼å æ­¤ GRU å¨ LSTM çåºç¡ä¸ç®åäºåæ°ï¼ä»èä½¿å¾æ¨¡åè½å¤æ´å¿«å¾æ¶æã
  ![i0Td8P.jpg](https://s1.ax1x.com/2018/10/20/i0Td8P.jpg)
  
  ## è¯åµå¥
- æ·±åº¦å­¦ä¹ çä¸å¤§å¥½å¤å°±æ¯è½èªå¨å­¦ä¹ ç¹å¾ï¼å¨èªç¶è¯­è¨å¤çä¸­ï¼æä»¬ä¸é¨ç¨word2vecä¹ç±»çææ¯å­¦ä¹ è¯è¯­çç¹å¾è¡¨ç¤ºï¼å³è¯åµå¥ã
- è¯åéï¼Word Vectorï¼è¡¨ç¤ºï¼åç§°è¯åµå¥ï¼Word Embeddingï¼ï¼æä»¥è¿ç»­å¼åéå½¢å¼è¡¨ç¤ºï¼Distributed Representationï¼è¯è¯­ï¼èä¸æ¯ç¨ç¦»æ£çæ¹å¼è¡¨ç¤ºï¼One-hot Representationï¼ãå¨ä¼ ç»çç¦»æ£è¡¨ç¤ºä¸­ï¼ä¸ä¸ªè¯ç¨ä¸ä¸ªé¿åº¦ä¸º V çåéè¡¨ç¤ºï¼å¶ä¸­ V æ¯è¯å¸å¤§å°ãåéä¸­åªæä¸ä¸ªåç´ ä¸º 1ï¼å¶ä½åç´ ä¸º 0ï¼åç´  1çä½ç½®ä»£è¡¨è¿ä¸ªè¯å¨è¯å¸ä¸­çä¸æ ãç¨ç¦»æ£çæ¹å¼å­å¨åè¯æçä½ä¸ï¼ä¸åéæ æ³åæ åè¯çè¯­ä¹è¯­æ³ç¹å¾ï¼èè¯åéå¯ä»¥è§£å³ä»¥ä¸é®é¢ãè¯åéå°åéçç»´
  åº¦ä» V éä½å° $\sqrt[k] V$ï¼ä¸è¬ k å 4ï¼ï¼æ¯ä¸ªåç´ çå¼ä¸åæ¯ 1 å 0ï¼èæ¯è¿ç»­å¼ãè¯åéæ¯å»ºç«ç¥ç»ç½ç»è¯­è¨æ¨¡å (Neural Network Language Modelï¼NNLM)å¯¹è¯­æè¿è¡çç£å­¦ä¹ å¾å°çå¯äº§ç©ï¼æ­¤æ¨¡åçæåºåºäºä¸ä¸ªè¯­è¨å­¦ä¸çåè®¾ï¼å·æç¸è¿è¯­ä¹çè¯æç¸ä¼¼çä¸ä¸æï¼å³ NNLM æ¨¡åè½å¤å¨ç»å®ä¸ä¸æç¯å¢çæ¡ä»¶ä¸æ±åºç¸åºä¸­å¿è¯ã
- ä¸å¾å±ç¤ºäºword2vecä¸­çskipgramæ¨¡åï¼
  ![i0Twgf.jpg](https://s1.ax1x.com/2018/10/20/i0Twgf.jpg)
- å¾å°çè¯åµå¥ç©éµå¦ä¸ï¼
  ![i0T0v8.jpg](https://s1.ax1x.com/2018/10/20/i0T0v8.jpg)
- Mikolovç­äººå¨NNLMåºç¡ä¸æåºäº Word2Vec æ¨¡åï¼æ­¤æ¨¡åè¿è¡çç£å­¦ä¹ çè¾å¥è¾åºåå«ä¸ºä¸­å¿è¯ä¸ä¸ä¸æï¼å³ Skip Gram æ¨¡å) æèä¸ä¸æä¸ä¸­å¿è¯ï¼å³ CBOW æ¨¡åï¼ãä¸¤ç§æ¹å¼åè½ææè®­ç»åºé«è´¨éçè¯åéï¼ä½æ¯ CBOW æ¨¡åæ¯æ ¹æ®ä¸ä¸ææ±ä¸­å¿è¯ï¼è®­ç»éåº¦å¿«ï¼éåå¨å¤§è¯­æä¸è®­ç»ï¼Skip Gram æ¨¡åè½ååå©ç¨è®­ç»è¯­æï¼å¶æ¬èº«å«ä¹ä¸ºâè·³è·çè¯­æ³æ¨¡åâï¼ä¸ä»ä½¿ç¨ç¸é»è¯ææä¸­å¿è¯çä¸ä¸æç¯å¢ï¼éä¸ä¸ªè¯çè·³è·è¯ä¹ææä¸ä¸æç¯å¢ï¼ä»¥å¾ 2-1 ä¸ºä¾ï¼è¯­æä¸­çä¸ä¸ªä¸­å¿è¯çä¸ä¸æåæ¬åä¸ªè¯ï¼åå¦è¯­æä¸­æ Wtotal ä¸ªè¯è¯­ï¼å Skip Gram æ¨¡åè½è®¡ç® 4 Â· Wtotal æ¬¡æå¤±å¹¶è¿è¡ååä¼ æ­å­¦ä¹ ï¼å¯¹äºè¯­æçå­¦ä¹ æ¬¡æ°æ¯ CBOW æ¨¡åçååï¼å æ­¤è¯¥æ¨¡åéåäºååå©ç¨å°è¯­æè®­ç»è¯åéã
- Word2Vec æ¨¡åè®­ç»å®ææ¶ï¼è¾å¥å±ä¸éèå±ä¹é´çæéç©éµå³è¯åµå¥ç©éµï¼Word Embedding Matrixï¼ãç¦»æ£è¡¨ç¤ºåè¯çåéä¸ç©éµç¸ä¹å³å¾å°è¯åéï¼è¿é¡¹æä½å®éä¸ç­æäºå¨è¯åµå¥ç©éµä¸­æ¥æ¾å¯¹åºè¯åéï¼Embedding Look Upï¼ãè¯åéè½å¤ææè¡¨ç¤ºè¯çè¯­ä¹å³ç³»ï¼å¶æ¬è´¨æ¯ä¸ºæºå¨å­¦ä¹ æ¨¡åæä¾äºä¸ç§æåææ¬ä¿¡æ¯ç¹å¾çæ¹æ³ï¼æ¹ä¾¿å°åè¯æ°å¼åè¾å¥æ¨¡åè¿è¡å¤çãä¼ ç»çè¯­è¨æ¨¡åè®­ç»è¯åéå¨è¾åº Softmax å±å¼éå¤ªå¤§ï¼
- è Word2Vec æ¨¡åéç¨äºåå± Softmaxï¼Hierarchical Softmaxï¼ååªå£°å¯¹æ¯ä¼°è®¡ï¼Noise Contrastive Estimationï¼ä¸¤ç§ææ¯ï¼å¤§å¤§å éäºè®­ç»ï¼ä½¿å¾å¨èªç¶è¯­è¨å¤çä¸­ä½¿ç¨å¤§è§æ¨¡è¯­æè®­ç»åºçä¼è´¨è¯åéæä¸ºå¯è½ã

## æ³¨æå

- å¨ NLP ä»»å¡ä¸­æ³¨æåæºå¶ææ©åºç¨äºæºå¨ç¿»è¯ï¼å³å¼å¥ä¸ä¸ªæéç©éµä»£è¡¨ç¼ç å¨åºåä¸­åä¸ªåç´ å¯¹è§£ç å¨çæçæ¯ä¸ä¸ªè¯çè´¡ç®ç¨åº¦ãå¨å®éå®ç°æ¶æ³¨æåæºå¶ä¼çæä¸ä¸ªæ³¨æåæéï¼å¯¹åä¸ªç¼ç å¨åç´ çéèå±ç¶æè¿è¡æ³¨æåå æçæä¸­é´è¡¨ç¤ºï¼èä¸æ¯ç®åçéç¨æåä¸ä¸ªåç´ çéèå±ç¶æãæç®åçæ³¨æåå³è§£ç å¨å¯¹ç¼ç å¨çæ³¨æåï¼åä¸ºå¨å±åå±é¨æ³¨æåãå¨å±æ³¨æåçæå¯¹æ´ä¸ªç¼ç å¨åºåçæ³¨æåæéï¼èå±é¨æ³¨æååè®­ç»åºä¸ä¸ªæ³¨æåå¯¹é½ä½ç½®ï¼åå¯¹æ­¤ä½ç½®éè¿åä¸ä¸ªçªå£ï¼ä»å¯¹çªå£åçåºåå æï¼ä½¿å¾æ³¨æåæ´å ç²¾ç¡®ãéä¸­ãæ³¨æåæºå¶å¸¦æ¥çä¸ä¸ªå¯äº§åå³è¯ä¸è¯ä¹é´çå¯¹é½Alignmentï¼ãå¨æºå¨ç¿»è¯ä¸­ï¼å¯¹é½å³ç³»å¯ä»¥çè§£ä¸ºè¯å°ç¿»è¯è¯çå³èç¨åº¦ãå¨èªå¨ææä¸­éç¨æ³¨æåæºå¶ï¼å¯ä»¥ææç¼è§£é¿åºåç»è¿ç¼ç å¨ç¼ç æä¸­é´è¡¨ç¤ºæ¶çä¿¡æ¯æå¤±é®é¢ã
  ![i0TDKS.jpg](https://s1.ax1x.com/2018/10/20/i0TDKS.jpg)

## åºåå°åºå

- seq2seqæ¨¡åï¼å³ä½¿ç¨ä¸ä¸ªRNNä½ä¸ºç¼ç å¨ï¼ç¼ç è¾å¥çåºåæ°æ®å¾å°ä¸­é´è¯­ä¹è¡¨ç¤ºï¼åå©ç¨å¦å¤ä¸ä¸ªRNNä½ä¸ºè§£ç å¨ï¼å©ç¨ä¸­é´è¯­ä¹è¡¨ç¤ºå¾å°åºååçè¾åºãå¹¿ä¹çåºåå°åºåä»¥åç«¯å°ç«¯å­¦ä¹ ä¸ä¸å®ä½¿ç¨RNNï¼ä¹å¯ä»¥ç¨CNNæèçº¯æ³¨æåæºå¶ã
  ![i0TrDg.jpg](https://s1.ax1x.com/2018/10/20/i0TrDg.jpg)
- å¯¹äºåºåå°åºåæ¨¡åçä¸äºä¸ªäººçè§£ï¼
  - ï¼ä¿¡æ¯è®ºï¼å¦æä¸èèç¼ç å¨åè§£ç å¨çå·ä½å®ç°å½¢å¼ï¼åªè®¤ä¸ºç¼ç å¨å¯ä»¥å°åºåæ°æ®è½¬åä¸ºä¸­é´è¡¨ç¤ºï¼è§£ç å¨å¯ä»¥å°ä¸­é´è¡¨ç¤ºè½¬åä¸ºåºåæ°æ®ï¼åæ´ä¸ªåºåå°åºåæ¨¡åç¸å½äºå¯¹ææä¿¡æ¯çä¸æ¬¡ç¼ç è§£ç ï¼ç±äºä¸­é´è¡¨ç¤ºçç»´åº¦è¿å°äºç¼ç å¨çæ»ç»´åº¦ï¼å æ­¤è¿ç§ç¼ç æ¯ææç¼ç ãåºåå°åºåæ¨¡åè¦ä½¿å¾ææç¼ç çç»ææ¯æååæä¸­çææä¿¡æ¯ï¼å æ­¤è®­ç»ç½ç»çç®æ æ¯è®©æå¤±çé¨åä¸ºææä¸éè¦çåä½ä¿¡æ¯ãè§£ç å¨ç¸å½äºç¼ç å¨çéè¿ç¨ï¼ä»åå«ææä¿¡æ¯çä¸­é´è¡¨ç¤ºä¸­è¿ååºææçåºåå½¢å¼æ°æ®ã
  - ï¼å­¦ä¹ ä¸åºç¨ï¼å°æ´ä¸ªæ¨¡åæ¯ä½äººç±»çå¤§èï¼åç¼ç å¨çéèå±ç¶æç¸å½äºå¤§èåå­å¨çç¥è¯ï¼è§£ç å¨åæ¯å©ç¨è¿äºç¥è¯è§£å³é®é¢ï¼å³ç¼ç å¨æ¯ä¸ä¸ªå­¦ä¹ è¿ç¨èè§£ç å¨æ¯ä¸ä¸ªåºç¨è¿ç¨ãè¿ç§æ¯å»è½å¤å½¢è±¡å°è§£éåæ¥å¯¹åºåå°åºåæ¨¡åçåç§æ¹è¿ï¼æ¶é´æ­¥ä¸çå­¦ä¹ å¯¹åºç°å®æ¶é´çº¿ä¸çå­¦ä¹ ï¼è¶æ©å­¦ä¹ çç¥è¯å¨å¤§èä¸­è¶å®¹æå¿è®°ï¼é åçæ¶é´æ­¥éèå±ä¿¡æ¯ä¼ éå°æç»æ­¥æ¶ä¿¡æ¯ä¸¢å¤±ä¸¥éï¼ï¼ä¸å¤§èçå®¹éä¸å®ï¼ä¸­é´è¡¨ç¤ºçä¿¡æ¯å­å¨å®¹éä¸å®ï¼ï¼å æ­¤å­¦ä¹ æ¶æä»¬éæ©æ§è®°å¿åå¿è®°ä¿¡æ¯ï¼LSTM å GRU çåºç¨ï¼ï¼å¹¶ä¸å¨è®°å¿çè¿ç¨ä¸­åéç¹ï¼æ³¨æåæºå¶ï¼ï¼çè³è¿å¯ä»¥åå©åå¤çç¯å¢æ¥è¯¢ä¿¡æ¯ï¼ä¸å®å¨é èªå·±çè®°å¿è§£å³é®é¢ï¼è®°å¿ç½ç»ï¼ã
  - ï¼å¾ªç¯ç¥ç»ç½ç»ï¼å®å¨ä»æ°æ®æµåç½ç»ç»æçè§åº¦çï¼æ´ä¸ªåºåå°åºåæ¨¡åå¯ä»¥çä½ä¸ä¸ªé¿çãéå®äºæäºæ¶é´æ­¥è¾å¥è¾åºç RNNï¼ä»¥å¾ 3-1 ä¸ºä¾ï¼æ¨¡åå°±æ¯ä¸ä¸ªå·æ 8 ä¸ªæ¶é´æ­¥ç RNNï¼å 5 æ¶é´æ­¥æ²¡æè¾åºï¼å 3 ä¸ªæ¶é´æ­¥å°è¾åºä¼ éå°ä¸ä¸æ¶é´æ­¥æå¯¼ç¶æååãç¼ç å¨åè§£ç å¨èåè®­ç»å³ç¸å½äºå¯¹è¿ä¸ªå¤§åRNN è¿è¡è®­ç»ãè¿ç§åªå¨é¨åèç¹è¿è¡è¾å¥è¾åºç RNN ä»ç»æä¸å°±éåå¤çåºåå°åºåä»»å¡ã

## åºåæå¤±

- è§£ç å¨æ¯ä¸æ­¥è§£ç åºæ¥çå®éä¸æ¶è¯å¸çæ¦çåå¸ï¼åæå¤§æ¦ççè¯è¾åºï¼æèåææç´¢ï¼ï¼æå¤±æ¯æ¯ä¸æ­¥çæ¦çåè¿ä¸æ­¥æ åè¯è¯­ç01åå¸åäº¤åçµï¼æ±ååå¹³åãå®éä¸è¿è¦åºç¨ä¸ä¸ªmaskæ¥è§£å³å¥å­é¿åº¦ä¸ä¸å®çé®é¢ã

# åºæ¬æ¨¡å

- é¢å¤çï¼åºç¨åºåå°åºåæ¨¡åéè¦å¯¹æ°æ®è¿è¡ä¸å®çé¢å¤çï¼é¤äºå¸¸ç¨çå»åç¨è¯å UNKï¼ä»¥åpaddingä¹å¤ï¼è¿éè¦è®¾è®¡è§£ç çå¼å§ä¸ç»æç¬¦å·ï¼å¦ä¸ï¼
  ![i0TsbQ.jpg](https://s1.ax1x.com/2018/10/20/i0TsbQ.jpg)
- è®­ç»å¥½è¯åµå¥ä¹åï¼å¯¹è¾å¥åä¸ä¸ªembedding lookupçæä½å¾å°ç¹å¾
  ![i0T6Ej.jpg](https://s1.ax1x.com/2018/10/20/i0T6Ej.jpg)
- ç¹å¾è¾å¥ç¼ç å¨å¾å°ä¸­é´è¡¨ç¤º
  ![i0Tg5n.png](https://s1.ax1x.com/2018/10/20/i0Tg5n.png)
- æ¿å°ä¸­é´è¡¨ç¤ºåè¾åºææ(ç¸å½äºlabel)ï¼è¾å¥è§£ç å¨è¿è¡è§£ç 
  ![i0TIrF.png](https://s1.ax1x.com/2018/10/20/i0TIrF.png)
- å å¥æ³¨æåæºå¶åå®æ´çåºåå°åºåæ¨¡åç»æå¦ä¸ï¼
  ![i0TRCq.jpg](https://s1.ax1x.com/2018/10/20/i0TRCq.jpg)

# ææèåæºå¶

- æææºå¶ä¸»è¦æ¯ä¸ºææ¬è¡¥åäºææç¹å¾ï¼éè¿æ¥æ¾ææè¯å¸çæ¹å¼æå¨æé äºä¸ä¸ªå­ç»´çç¹å¾ï¼æªæ¥å¸æè½å¤ç¨èªå¨æé ç¹å¾çæ¹å¼æ¥è¿è¡è¿æ¹é¢å·¥ä½ã
- åè®­ç»ææåç±»å¨ï¼å¯¹åè¯­æè¿è¡äºç­éå½¢æææè¯­æï¼å¨ææè¯­æåæ®éè¯­æä¸é½æµè¯äºæ¨¡å
  ![i0TW80.jpg](https://s1.ax1x.com/2018/10/20/i0TW80.jpg)
- æ¥æ¾è¯å¸å¾å°ææåéï¼å³ææç¹å¾ï¼
  ![i0Tf2V.jpg](https://s1.ax1x.com/2018/10/20/i0Tf2V.jpg)
- å°ææç¹å¾ç´æ¥æ¼æ¥å¨ä¸­é´è¡¨ç¤ºä¹åï¼è¾å¥è§£ç å¨
  ![i0ThvT.jpg](https://s1.ax1x.com/2018/10/20/i0ThvT.jpg)

# ç»æ

- ç»æç±ROUGE-F1å¼å½¢å¼è®°å½ï¼ææè¯­æä¸åç§æ¹æ³å¯¹æ¯
  ![i0T5KU.png](https://s1.ax1x.com/2018/10/20/i0T5KU.png)
- æ®éè¯­æä¸ææèåæ¹æ¡å¯¹æ¯
  ![i0Tb5R.png](https://s1.ax1x.com/2018/10/20/i0Tb5R.png)
- ææåç±»åç¡®çï¼ä½ä¸ºåèï¼ä¹åè®­ç»çææåç±»å¨åç¡®çä¸º74%
  ![i0Tob4.png](https://s1.ax1x.com/2018/10/20/i0Tob4.png)
- å ä¸ºæ¯å¤§è¯­æå°batchè®­ç»ï¼åªè®­ç»äºåæ¬¡è¿­ä»£ï¼åä¸ªè¿­ä»£çæµè¯éææ
  ![i0T7VJ.png](https://s1.ax1x.com/2018/10/20/i0T7VJ.png)

# é®é¢

- unkæ¿æ¢é®é¢ï¼å¨å¾å¤æç®ä¸­é½æå°äºä½¿ç¨æéå¼å³ææ¯è§£å³çæææä¸­çç½è§è¯ï¼unk)ï¼å³ä»åæä¸­æéè¯è¯­æ¿æ¢æææä¸­çunkï¼ä½æ¯ç±äºROUGEè¯æµçæ¯è¯çå±ç°ç¨åº¦ï¼å æ­¤åªè¦æ¿æ¢äºåæçè¯ï¼åªæä½ç½®ãè¯è¯­ä¸å¯¹ï¼é½æå¯è½æ¯ROUGEå¼ä¸åï¼é æè¯æµç»æåé«ï¼æ¬æè®¾è®¡äºå¯¹æ¯è¯éªï¼åç°å³ä¾¿æ¯æ²¡æéç¨ä»»ä½æºå¶çéæºæ¿æ¢é½è½æé«ROUGEå¼
  ![i0THa9.png](https://s1.ax1x.com/2018/10/20/i0THa9.png)
- è¯­æéå¤é®é¢ï¼å¨æ£æ¥è¯­ææ¶æä»¬åç°äºå¤§éç­ææ¬ä¸åä½ç­ææç¸åçè¯­æï¼éå¤çè¯­ææ¥èªäºå¯¹äºç¸åäºä»¶çä¸åæè¿°ï¼æèä¸äºåè½æ§çæå­ï¼ç¿»è¯è¿æ¥ä¾å¦â...... å¨ä¸...... é»éä»·æ ¼ä¸æ¶¨âåâ......å¨å......é»éä»·æ ¼ä¸æ¶¨âåçæç¸åçææâé»éä»·æ ¼ä¸æ¶¨âãç­ææéå¤çè¯­æä¼å¯¼è´æ¨¡åå¨è§£ç ç«¯å­¦å°ä¸äºä¸åºè¯¥åºåçç­è¯­ï¼èå¦æè®­ç»éåæµè¯éä¸­æéå¤çç¸åçææï¼ååºåçææåèä¼å¯¼è´çææææ­£ç¡®çèé«ãå¯¹äºè¿ç±»ææ¬ï¼æ¬æè¿è¡äºåç»å®éªï¼
  - ä¸å»éï¼ä¿çåææ¬ï¼ä¸å»éï¼è¿è¡è®­ç»åæµè¯
  - å»éï¼å é¤è¯­æä¸­ææéå¤ææå¯¹åºççç­ææ¬-ç­ææå¯¹ã
  - è®­ç»å»éï¼é¨åå»éï¼åªå°è®­ç»è¯­æä¸­çéå¤æ°æ®å é¤ï¼å³å­¦ä¹ å¥½çæ¨¡åå·²ç»æ²¡æåå°éå¤ææ¬çå½±åã
  - æµè¯å»éï¼é¨åå»éï¼åªå°æµè¯éä¸­ä¸è®­ç»ééå¤çé¨åå é¤ï¼å­¦ä¹ å¥½çæ¨¡ååå°äºéå¤ææ¬çå½±åï¼ä½æµè¯éä¸­æ²¡æä¸éå¤ææ¬ä¸­ç¸å¯¹åºçæ°æ®ã
    éå¤çè¯­æè®­ç»ä¸ ROUGE-1 å ROUGE-L é½çªç ´äº 30ï¼è¿è¶æ­£å¸¸è®­ç»çæ¨¡åï¼å»éä¹åä¾¿æ¢å¤å°æ­£å¸¸æ°´å¹³ãä¸¤ç§é¨åå»éçç»æååå«è¡¨æï¼è®­ç»å»éæ¶ï¼æ²¡æåéå¤è¯­æå½±åçæ¨¡åå¯¹äºæµè¯éä¸­çéå¤æ°æ®æ²¡æææ¾çååºï¼ä¸å®å¨å»éçæ®éæ¨¡åè¿ä¼¼ï¼æµè¯å»éæ¶ï¼è½ç¶æ¨¡ååå°äºéå¤è¯­æå½±åï¼ä½æ¯æµè¯éä¸­æ²¡æéå¤çæ°æ®è®©å¶å©ç¨å­¦ä¹ å°çåºåçææï¼å æ­¤ç»æä¹ä¸ä¼èé«ï¼ä¸ç±äºå­¦ä¹ å°äºä¸åç­æå¯¹åºç¸åææçæ¨¡å¼ï¼ç¼ç ç«¯å®éä¸ç»ææ´å çµæ´»ï¼å¯¼è´ ROUGE ææ é«äºè®­ç»å»éçç»æã
    ![i0TLP1.png](https://s1.ax1x.com/2018/10/20/i0TLP1.png)

# å®ç°ç¯å¢

- è¿éæ¯githubå°åï¼-    [Abstract_Summarization_Tensorflow](https://github.com/thinkwee/Abstract_Summarization_Tensorflow)
- Ubuntu 16.04
- Tensorflow 1.6
- CUDA 9.0
- Cudnn 7.1.2
- Gigawordsæ°æ®éï¼è®­ç»äºé¨åæ°æ®ï¼çº¦30ä¸
- GTX1066ï¼è®­ç»æ¶é´3å°4ä¸ªå°æ¶

# åèæç®

![i0TX26.jpg](https://s1.ax1x.com/2018/10/20/i0TX26.jpg)
![i0TO8x.jpg](https://s1.ax1x.com/2018/10/20/i0TO8x.jpg)

{% endlang_content %}


<script src="https://giscus.app/client.js"
        data-repo="thinkwee/thinkwee.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnk3OTYxNjMwOA=="
        data-category="Announcements"
        data-category-id="DIC_kwDOBL7ZNM4CkozI"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>