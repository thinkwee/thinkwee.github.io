<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Noto+Serif+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"thinkwee.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"duration":50,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Using the data from the Titanic as an example, introduce the basic operations performed on the data in the early stages.">
<meta property="og:type" content="article">
<meta property="og:title" content="Pandas Basics">
<meta property="og:url" content="https://thinkwee.top/2017/02/04/pandas-skill/index.html">
<meta property="og:site_name" content="Thinkwee&#39;s Blog">
<meta property="og:description" content="Using the data from the Titanic as an example, introduce the basic operations performed on the data in the early stages.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0Tn41.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TP3V.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TFjU.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TAuF.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TEB4.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TmNR.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TVHJ.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TeE9.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TK9x.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TM36.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TljO.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TcUs.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TQgK.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i07jFs.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0T3uD.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0T8De.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0Tn41.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TP3V.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TFjU.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TAuF.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TEB4.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TmNR.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TVHJ.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TeE9.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TK9x.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TM36.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TljO.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TcUs.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0TQgK.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i07jFs.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0T3uD.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2018/10/20/i0T8De.jpg">
<meta property="article:published_time" content="2017-02-04T13:02:39.000Z">
<meta property="article:modified_time" content="2025-07-15T20:42:34.667Z">
<meta property="article:author" content="Thinkwee">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="code">
<meta property="article:tag" content="math">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2018/10/20/i0Tn41.jpg">


<link rel="canonical" href="https://thinkwee.top/2017/02/04/pandas-skill/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://thinkwee.top/2017/02/04/pandas-skill/","path":"2017/02/04/pandas-skill/","title":"Pandas Basics"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Pandas Basics | Thinkwee's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-96114782-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-96114782-1","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><script>(function() {function calculateHeight(element) {let height = 0;const items = element.children;for (let i = 0; i < items.length; i++) {height += items[i].offsetHeight || 25;const child = items[i].querySelector(".nav-child");if (child && child.style.display !== "none") {height += calculateHeight(child);}}return height;}function generateToc(lang, container) {const content = document.getElementById(lang + "-content");if (!content) return;const headers = Array.from(content.querySelectorAll("h1, h2, h3, h4, h5, h6"));if (headers.length === 0) return;const ol = document.createElement("ol");ol.className = "nav";let currentLevel = 1;let currentOl = ol;let stack = [ol];let counters = [0, 0, 0, 0, 0, 0];headers.forEach((header, index) => {const level = parseInt(header.tagName[1]);counters[level - 1]++;for (let i = level; i < 6; i++) counters[i] = 0;const li = document.createElement("li");li.className = "nav-item nav-level-" + level;if (level === 1 && index === 0) {li.classList.add("active", "active-current");}const link = document.createElement("a");link.className = "nav-link";if (level === 1 && index === 0) link.classList.add("active");link.href = "#" + header.id;const numSpan = document.createElement("span");numSpan.className = "nav-number";numSpan.textContent = counters.slice(0, level).filter(n => n > 0).join(".");const textSpan = document.createElement("span");textSpan.className = "nav-text";textSpan.textContent = header.textContent;link.appendChild(numSpan);link.appendChild(document.createTextNode(" "));link.appendChild(textSpan);li.appendChild(link);if (level > currentLevel) {const newOl = document.createElement("ol");newOl.className = "nav-child";if (currentLevel === 1) {newOl.style.display = "block";stack[currentLevel - 1].lastElementChild.classList.add("active");}stack[currentLevel - 1].lastElementChild.appendChild(newOl);stack[level - 1] = newOl;currentOl = newOl;} else if (level < currentLevel) {currentOl = stack[level - 1];}currentOl.appendChild(li);currentLevel = level;});container.appendChild(ol);setTimeout(() => {const navHeight = calculateHeight(ol);ol.style.setProperty("--height", navHeight + "px");const navChilds = ol.getElementsByClassName("nav-child");Array.from(navChilds).forEach(child => {if (child.style.display === "block") {const childHeight = calculateHeight(child);child.style.setProperty("--height", childHeight + "px");}});}, 0);return ol;}function updateActiveHeading() {const activeLang = document.getElementById("en-content").style.display === "block" ? "en" : "zh";const content = document.getElementById(activeLang + "-content");const toc = document.getElementById(activeLang + "-toc");if (!content || !toc) return;const headers = Array.from(content.querySelectorAll("h1, h2, h3, h4, h5, h6"));const scrollPos = window.scrollY + window.innerHeight / 3;let activeHeader = null;for (let i = headers.length - 1; i >= 0; i--) {const header = headers[i];const headerTop = header.getBoundingClientRect().top + window.scrollY;if (headerTop <= scrollPos) {activeHeader = header;break;}}const links = toc.getElementsByClassName("nav-link");Array.from(links).forEach(link => {link.classList.remove("active");const parentLi = link.parentElement;if (parentLi) {parentLi.classList.remove("active", "active-current");}});if (activeHeader) {const activeLink = toc.querySelector(`a[href="#${activeHeader.id}"]`);if (activeLink) {activeLink.classList.add("active");let parent = activeLink.parentElement;while (parent && parent.classList) {if (parent.classList.contains("nav-item")) {parent.classList.add("active");if (parent.classList.contains("nav-level-1")) {parent.classList.add("active-current");}}parent = parent.parentElement;}}}}function initTippy() {document.querySelectorAll(".refplus-num").forEach((ref) => {if (ref._tippy) {ref._tippy.destroy();}let refid = ref.firstChild.href.replace(location.origin+location.pathname,"");let refel = document.querySelector(refid);if (!refel) return;let refnum = refel.dataset.num;let ref_content = refel.innerText.replace(`[${refnum}]`,"");tippy(ref, {content: ref_content,});});}function initToc() {const originalToc = document.querySelector(".post-toc-wrap");if (!originalToc || !document.getElementById("langToggle")) return;const tocContainer = document.createElement("div");tocContainer.className = "post-toc-wrap sidebar-panel sidebar-panel-active";const enToc = document.createElement("div");enToc.id = "en-toc";enToc.className = "post-toc motion-element";enToc.style.display = "block";const zhToc = document.createElement("div");zhToc.id = "zh-toc";zhToc.className = "post-toc motion-element";zhToc.style.display = "none";generateToc("en", enToc);generateToc("zh", zhToc);tocContainer.appendChild(enToc);tocContainer.appendChild(zhToc);originalToc.parentNode.replaceChild(tocContainer, originalToc);window.addEventListener("scroll", updateActiveHeading);setTimeout(updateActiveHeading, 0);}window.toggleLanguage = function() {const enContent = document.getElementById("en-content");const zhContent = document.getElementById("zh-content");const enToc = document.getElementById("en-toc");const zhToc = document.getElementById("zh-toc");const button = document.getElementById("langToggle");if (!enContent || !zhContent || !enToc || !zhToc || !button) return;const isEnglish = enContent.style.display === "block";enContent.style.display = isEnglish ? "none" : "block";zhContent.style.display = isEnglish ? "block" : "none";enToc.style.display = isEnglish ? "none" : "block";zhToc.style.display = isEnglish ? "block" : "none";button.querySelector(".button-text").textContent = isEnglish ? "Switch to English" : "切换中文";setTimeout(updateActiveHeading, 0);setTimeout(initTippy, 100);};document.addEventListener("DOMContentLoaded", function() {initToc();setTimeout(initTippy, 3000);});})();</script><style>.post-toc { transition: all 0.2s ease-in-out; }.post-toc .nav { padding-left: 0; }.post-toc .nav-child { padding-left: 1em; }.post-toc .nav-item { line-height: 1.8; }.post-toc .nav-link { color: #555; }.post-toc .nav-link:hover { color: #222; }.post-toc .nav-link.active { color: #fc6423; }.post-toc .active > .nav-link { color: #fc6423; }.post-toc .active-current > .nav-link { color: #fc6423; }</style><!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Thinkwee's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Too Stupid to Give Up Learning</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">53</span></a></li><li class="menu-item menu-item-multi-agent-ebook"><a href="/multiagent_ebook/" rel="section"><i class="fa fa-book fa-fw"></i>Multi-Agent EBook</a></li><li class="menu-item menu-item-iagents"><a href="/iagents/" rel="section"><i class="fa fa-robot fa-fw"></i>iAgents</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#introducing-the-library"><span class="nav-number">1.</span> <span class="nav-text">Introducing the library</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#read-file"><span class="nav-number">2.</span> <span class="nav-text">Read file</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#or-data-overview"><span class="nav-number">3.</span> <span class="nav-text">or Data Overview</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-manipulation"><span class="nav-number">4.</span> <span class="nav-text">Data Manipulation</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-selection"><span class="nav-number">5.</span> <span class="nav-text">Data Selection</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#handling-missing-values"><span class="nav-number">6.</span> <span class="nav-text">Handling Missing Values</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#applied-functions"><span class="nav-number">7.</span> <span class="nav-text">Applied Functions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="nav-number">8.</span> <span class="nav-text">Data 透视表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-merging"><span class="nav-number">9.</span> <span class="nav-text">Data merging</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%95%E5%85%A5%E5%BA%93"><span class="nav-number">10.</span> <span class="nav-text">引入库</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-number">11.</span> <span class="nav-text">读取文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%A6%82%E8%A7%88"><span class="nav-number">12.</span> <span class="nav-text">数据概览</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="nav-number">13.</span> <span class="nav-text">数据操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%80%89%E6%8B%A9"><span class="nav-number">14.</span> <span class="nav-text">数据选择</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="nav-number">15.</span> <span class="nav-text">缺失值处理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">16.</span> <span class="nav-text">应用函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="nav-number">17.</span> <span class="nav-text">数据透视表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6"><span class="nav-number">18.</span> <span class="nav-text">数据合并</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Thinkwee</p>
  <div class="site-description" itemprop="description">Failed Better</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">61</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/thinkwee" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;thinkwee" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:thinkwee2767@gmail.com" title="E-Mail → mailto:thinkwee2767@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/thinkwee2767" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;thinkwee2767" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://scholar.google.com/citations?hl=en&user=QvW2leIAAAAJ" title="GScholar → https:&#x2F;&#x2F;scholar.google.com&#x2F;citations?hl&#x3D;en&amp;user&#x3D;QvW2leIAAAAJ" rel="noopener me" target="_blank"><i class="fa fa-graduation-cap fa-fw"></i>GScholar</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thinkwee.top/2017/02/04/pandas-skill/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Thinkwee">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Thinkwee's Blog">
      <meta itemprop="description" content="Failed Better">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Pandas Basics | Thinkwee's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pandas Basics
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-02-04 21:02:39" itemprop="dateCreated datePublished" datetime="2017-02-04T21:02:39+08:00">2017-02-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-07-16 04:42:34" itemprop="dateModified" datetime="2025-07-16T04:42:34+08:00">2025-07-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
    <span id="/2017/02/04/pandas-skill/" class="post-meta-item leancloud_visitors" data-flag-title="Pandas Basics" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>7.4k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>7 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Using the data from the Titanic as an example, introduce the basic
operations performed on the data in the early stages.</p>
<span id="more"></span>
<style>.lang-content {width: 100%;overflow: hidden;}.lang-content:not(:first-child) {display: none;}</style><div style="text-align: right; margin: 0 0 20px auto; max-width: 200px;"><button id="langToggle" onclick="toggleLanguage()" class="lang-switch-btn" style="width: 100%;padding: 10px 20px;border-radius: 8px;border: 2px solid #2c3e50;background-color: #fff;cursor: pointer;color: #2c3e50;font-size: 15px;transition: all 0.3s ease;display: flex;align-items: center;justify-content: center;gap: 8px;box-shadow: 0 2px 4px rgba(0,0,0,0.1);"><span class="button-text">切换中文</span></button></div>
<div id="en-content" class="lang-content" style="display: block;"><h1 id="introducing-the-library">Introducing the library</h1>
<pre><code>import csv as csv 
import pandas as pd
import numpy as np</code></pre>
<h1 id="read-file">Read file</h1>
<pre><code>train = pd.read_csv(r&quot;文件目录&quot;) </code></pre>
<p>At this moment, the style of the data is: <img data-src="https://s1.ax1x.com/2018/10/20/i0Tn41.jpg" alt="i0Tn41.jpg" /></p>
<h1 id="or-data-overview">or Data Overview</h1>
<ul>
<li><p>describe the common attributes of the overall data display</p>
<pre><code>print(train.describe())</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TP3V.jpg" alt="i0TP3V.jpg" />
<figcaption aria-hidden="true">i0TP3V.jpg</figcaption>
</figure></li>
<li><p>head tail display some data at the beginning and end</p>
<pre><code>print(train.head(5))
print(train.tail(3))</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TFjU.jpg" alt="i0TFjU.jpg" />
<figcaption aria-hidden="true">i0TFjU.jpg</figcaption>
</figure></li>
<li><p>index: index, default built-in integer index; columns: columns;
values: data values</p>
<pre><code>print(train.index)
print(train.columns)
print(train.values)</code></pre>
<h1 id="data-manipulation">Data Manipulation</h1></li>
<li><p>Data Transposition</p>
<pre><code>print(train.T)</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TAuF.jpg" alt="i0TAuF.jpg" />
<figcaption aria-hidden="true">i0TAuF.jpg</figcaption>
</figure></li>
<li><p>sort: Can be sorted by index or value, axis selects the dimension
(row or column), ascending selects ascending or descending order, and
NaN is always placed at the end, regardless of ascending or descending
order</p>
<pre><code>print(train.sort_index(axis=0,ascending=True))
print(train.sort_values(by=&quot;Age&quot;,ascending=False))</code></pre>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TEB4.jpg"
alt="i0TEB4.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TmNR.jpg"
alt="i0TmNR.jpg" /></p></li>
</ul>
<h1 id="data-selection">Data Selection</h1>
<ul>
<li><p>Select by tag, select columns, row slicing</p>
<pre><code>print(train[&#39;Age&#39;])
print(train[0:9])</code></pre>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TVHJ.jpg"
alt="i0TVHJ.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TeE9.jpg"
alt="i0TeE9.jpg" /></p></li>
<li><p>Utilize loc to freely select certain rows and columns; at can be
used instead</p>
<pre><code>print(train.loc[train.index[4:6]])
print(train.loc[:,[&#39;Age&#39;,&#39;Fare&#39;]])
print(train.loc[3:5,[&#39;Age&#39;,&#39;Fare&#39;]])
print(train.loc[4,&#39;Age&#39;])
print(train.at[4,&#39;Age&#39;])</code></pre></li>
<li><p>Using iloc to select by position</p>
<pre><code>print(train.iloc[5])
print(train.iloc[3:5,2:4])
print(train.iloc[[1,2,4],[2,5]])
print(train.iloc[3,3])</code></pre></li>
<li><p>Boolean selection</p>
<pre><code>print( train[ (train[&#39;Age&#39;]&gt;40) &amp; (train[&#39;Age&#39;]&lt;50) ] )
print(train[train[&#39;Parch&#39;].isin([1,2])])
print(train[pd.isnull(train[&#39;Age&#39;])==True])</code></pre>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TK9x.jpg"
alt="i0TK9x.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TM36.jpg"
alt="i0TM36.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TljO.jpg"
alt="i0TljO.jpg" /></p></li>
</ul>
<h1 id="handling-missing-values">Handling Missing Values</h1>
<ul>
<li><p>Using reindex to select and copy part of the data, and then
handle missing values. Some functions will automatically filter out
missing values, such as mean().</p>
<pre><code>train1=train.reindex(index=train.index[0:5],columns=[&#39;PassengerId&#39;]+[&#39;Age&#39;]+[&#39;Sex&#39;])#选择前5行，只取选定的三列
print(train1)
print(train1.dropna(axis=0)) #删除存在nan值的行
print(train1.dropna(subset=[&#39;Age&#39;,&#39;Sex&#39;])) #删除年龄性别列中存在nan值的行
print(pd.isnull(train1)) #nan值改为true，其余值改为false
print(train1.fillna(value=2333)) #缺失值替换为2333</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TcUs.jpg" alt="i0TcUs.jpg" />
<figcaption aria-hidden="true">i0TcUs.jpg</figcaption>
</figure>
<h1 id="applied-functions">Applied Functions</h1></li>
<li><p>Can write functions and apply them to the rows or columns of
data, selecting rows or columns through the axis parameter</p>
<pre><code>#写函数统计包含nan值的行数
def null_count(column):
column_null=pd.isnull(column)
null=column[column_null == True]
return len(null)
print(train.apply(null_count))</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TQgK.jpg" alt="i0TQgK.jpg" />
<figcaption aria-hidden="true">i0TQgK.jpg</figcaption>
</figure>
<pre><code>#写函数对年龄列进行分类
def judge(row):
if pd.isnull(row[&#39;Age&#39;]) ==True:
   return &#39;unknown&#39;
return &#39;youngth&#39; if row[&#39;Age&#39;]&lt;18 else &#39;adult&#39;
print(train.apply(judge,axis=1))</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i07jFs.jpg" alt="i07jFs.jpg" />
<figcaption aria-hidden="true">i07jFs.jpg</figcaption>
</figure>
<h1 id="data-透视表">Data 透视表</h1></li>
<li><p>Select categories and values for data pivot, such as categorizing
by pclass and sex, and calculating the average age and fare</p>
<pre><code>print(train.pivot_table(index=[&quot;Pclass&quot;,&quot;Sex&quot;], values=[&quot;Age&quot;, &quot;Fare&quot;], aggfunc=np.mean))</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0T3uD.jpg" alt="i0T3uD.jpg" />
<figcaption aria-hidden="true">i0T3uD.jpg</figcaption>
</figure></li>
</ul>
<h1 id="data-merging">Data merging</h1>
<ul>
<li><p>Some operations of data merging, to be completed</p>
<pre><code>import pandas as pd
data1 = pd.DataFrame({&#39;level&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;],
                 &#39;numeber&#39;:[1,3,5,7]})

data2=pd.DataFrame({&#39;level&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;e&#39;],
                 &#39;numeber&#39;:[2,3,6,10]})

print(&quot;merge:\n&quot;,pd.merge(data1,data2),&quot;\n&quot;)

data3 = pd.DataFrame({&#39;level1&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;],
                 &#39;numeber1&#39;:[1,3,5,7]})
data4 = pd.DataFrame({&#39;level2&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;e&#39;],
                 &#39;numeber2&#39;:[2,3,6,10]})
print(&quot;merge with left_on,right_on: \n&quot;,pd.merge(data3,data4,left_on=&#39;level1&#39;,right_on=&#39;level2&#39;),&quot;\n&quot;)

print(&quot;concat: \n&quot;,pd.concat([data1,data2]),&quot;\n&quot;)

data3 = pd.DataFrame({&#39;level&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;],
                 &#39;numeber1&#39;:[1,3,5,np.nan]})
data4=pd.DataFrame({&#39;level&#39;:[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;e&#39;],
                 &#39;numeber2&#39;:[2,np.nan,6,10]})
print(&quot;combine: \n&quot;,data3.combine_first(data4),&quot;\n&quot;)</code></pre>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0T8De.jpg" alt="i0T8De.jpg" />
<figcaption aria-hidden="true">i0T8De.jpg</figcaption>
</figure></li>
</ul>
</div>
<div id="zh-content" class="lang-content" style="display: none;"><h1 id="引入库">引入库</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv <span class="keyword">as</span> csv </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<h1 id="读取文件">读取文件</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train = pd.read_csv(<span class="string">r&quot;文件目录&quot;</span>) </span><br></pre></td></tr></table></figure>
<p>此时数据的样式是： <img data-src="https://s1.ax1x.com/2018/10/20/i0Tn41.jpg" alt="i0Tn41.jpg" /></p>
<h1 id="数据概览">数据概览</h1>
<ul>
<li><p>describe 显示整体数据常见属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.describe())</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TP3V.jpg" alt="i0TP3V.jpg" />
<figcaption aria-hidden="true">i0TP3V.jpg</figcaption>
</figure></li>
<li><p>head tail 显示首尾一些数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.head(<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(train.tail(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TFjU.jpg" alt="i0TFjU.jpg" />
<figcaption aria-hidden="true">i0TFjU.jpg</figcaption>
</figure></li>
<li><p>index：索引，默认自建整型索引；columns：列；values：数据数值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.index)</span><br><span class="line"><span class="built_in">print</span>(train.columns)</span><br><span class="line"><span class="built_in">print</span>(train.values)</span><br></pre></td></tr></table></figure>
<h1 id="数据操作">数据操作</h1></li>
<li><p>T：数据的转置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.T)</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TAuF.jpg" alt="i0TAuF.jpg" />
<figcaption aria-hidden="true">i0TAuF.jpg</figcaption>
</figure></li>
<li><p>sort：可以按索引或者值进行排序，axis选择维度(行还是列),ascending选择升序或者降序,Nan永远排在最后，无论升序降序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.sort_index(axis=<span class="number">0</span>,ascending=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span>(train.sort_values(by=<span class="string">&quot;Age&quot;</span>,ascending=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TEB4.jpg"
alt="i0TEB4.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TmNR.jpg"
alt="i0TmNR.jpg" /></p></li>
</ul>
<h1 id="数据选择">数据选择</h1>
<ul>
<li><p>按照标签选择，选择列，行切片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train[<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(train[<span class="number">0</span>:<span class="number">9</span>])</span><br></pre></td></tr></table></figure>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TVHJ.jpg"
alt="i0TVHJ.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TeE9.jpg"
alt="i0TeE9.jpg" /></p></li>
<li><p>利用loc自由选择某些行某些列，可以用at替代</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.loc[train.index[<span class="number">4</span>:<span class="number">6</span>]])</span><br><span class="line"><span class="built_in">print</span>(train.loc[:,[<span class="string">&#x27;Age&#x27;</span>,<span class="string">&#x27;Fare&#x27;</span>]])</span><br><span class="line"><span class="built_in">print</span>(train.loc[<span class="number">3</span>:<span class="number">5</span>,[<span class="string">&#x27;Age&#x27;</span>,<span class="string">&#x27;Fare&#x27;</span>]])</span><br><span class="line"><span class="built_in">print</span>(train.loc[<span class="number">4</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(train.at[<span class="number">4</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br></pre></td></tr></table></figure></li>
<li><p>利用iloc按照位置进行选择</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.iloc[<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(train.iloc[<span class="number">3</span>:<span class="number">5</span>,<span class="number">2</span>:<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(train.iloc[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">5</span>]])</span><br><span class="line"><span class="built_in">print</span>(train.iloc[<span class="number">3</span>,<span class="number">3</span>])</span><br></pre></td></tr></table></figure></li>
<li><p>布尔选择</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>( train[ (train[<span class="string">&#x27;Age&#x27;</span>]&gt;<span class="number">40</span>) &amp; (train[<span class="string">&#x27;Age&#x27;</span>]&lt;<span class="number">50</span>) ] )</span><br><span class="line"><span class="built_in">print</span>(train[train[<span class="string">&#x27;Parch&#x27;</span>].isin([<span class="number">1</span>,<span class="number">2</span>])])</span><br><span class="line"><span class="built_in">print</span>(train[pd.isnull(train[<span class="string">&#x27;Age&#x27;</span>])==<span class="literal">True</span>])</span><br></pre></td></tr></table></figure>
<p><img data-src="https://s1.ax1x.com/2018/10/20/i0TK9x.jpg"
alt="i0TK9x.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TM36.jpg"
alt="i0TM36.jpg" /> <img data-src="https://s1.ax1x.com/2018/10/20/i0TljO.jpg"
alt="i0TljO.jpg" /></p></li>
</ul>
<h1 id="缺失值处理">缺失值处理</h1>
<ul>
<li><p>利用reindex选择部分数据进行拷贝，并进行缺失值处理。一些函数会自动过滤掉缺失值，比如mean()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">train1=train.reindex(index=train.index[<span class="number">0</span>:<span class="number">5</span>],columns=[<span class="string">&#x27;PassengerId&#x27;</span>]+[<span class="string">&#x27;Age&#x27;</span>]+[<span class="string">&#x27;Sex&#x27;</span>])<span class="comment">#选择前5行，只取选定的三列</span></span><br><span class="line"><span class="built_in">print</span>(train1)</span><br><span class="line"><span class="built_in">print</span>(train1.dropna(axis=<span class="number">0</span>)) <span class="comment">#删除存在nan值的行</span></span><br><span class="line"><span class="built_in">print</span>(train1.dropna(subset=[<span class="string">&#x27;Age&#x27;</span>,<span class="string">&#x27;Sex&#x27;</span>])) <span class="comment">#删除年龄性别列中存在nan值的行</span></span><br><span class="line"><span class="built_in">print</span>(pd.isnull(train1)) <span class="comment">#nan值改为true，其余值改为false</span></span><br><span class="line"><span class="built_in">print</span>(train1.fillna(value=<span class="number">2333</span>)) <span class="comment">#缺失值替换为2333</span></span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TcUs.jpg" alt="i0TcUs.jpg" />
<figcaption aria-hidden="true">i0TcUs.jpg</figcaption>
</figure>
<h1 id="应用函数">应用函数</h1></li>
<li><p>可以自己写函数并应用到数据的行或者列，通过axis参数选择行列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#写函数统计包含nan值的行数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">null_count</span>(<span class="params">column</span>):</span><br><span class="line">column_null=pd.isnull(column)</span><br><span class="line">null=column[column_null == <span class="literal">True</span>]</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">len</span>(null)</span><br><span class="line"><span class="built_in">print</span>(train.apply(null_count))</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0TQgK.jpg" alt="i0TQgK.jpg" />
<figcaption aria-hidden="true">i0TQgK.jpg</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#写函数对年龄列进行分类</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">judge</span>(<span class="params">row</span>):</span><br><span class="line"><span class="keyword">if</span> pd.isnull(row[<span class="string">&#x27;Age&#x27;</span>]) ==<span class="literal">True</span>:</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&#x27;unknown&#x27;</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;youngth&#x27;</span> <span class="keyword">if</span> row[<span class="string">&#x27;Age&#x27;</span>]&lt;<span class="number">18</span> <span class="keyword">else</span> <span class="string">&#x27;adult&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(train.apply(judge,axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i07jFs.jpg" alt="i07jFs.jpg" />
<figcaption aria-hidden="true">i07jFs.jpg</figcaption>
</figure>
<h1 id="数据透视表">数据透视表</h1></li>
<li><p>自选分类和值进行数据透视，比如按照pclass和sex分类，统计age和fare的平均值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(train.pivot_table(index=[<span class="string">&quot;Pclass&quot;</span>,<span class="string">&quot;Sex&quot;</span>], values=[<span class="string">&quot;Age&quot;</span>, <span class="string">&quot;Fare&quot;</span>], aggfunc=np.mean))</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0T3uD.jpg" alt="i0T3uD.jpg" />
<figcaption aria-hidden="true">i0T3uD.jpg</figcaption>
</figure></li>
</ul>
<h1 id="数据合并">数据合并</h1>
<ul>
<li><p>数据合并的一些操作，待补全</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data1 = pd.DataFrame(&#123;<span class="string">&#x27;level&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>]&#125;)</span><br><span class="line"></span><br><span class="line">data2=pd.DataFrame(&#123;<span class="string">&#x27;level&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber&#x27;</span>:[<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;merge:\n&quot;</span>,pd.merge(data1,data2),<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">data3 = pd.DataFrame(&#123;<span class="string">&#x27;level1&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber1&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>]&#125;)</span><br><span class="line">data4 = pd.DataFrame(&#123;<span class="string">&#x27;level2&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber2&#x27;</span>:[<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;merge with left_on,right_on: \n&quot;</span>,pd.merge(data3,data4,left_on=<span class="string">&#x27;level1&#x27;</span>,right_on=<span class="string">&#x27;level2&#x27;</span>),<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;concat: \n&quot;</span>,pd.concat([data1,data2]),<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">data3 = pd.DataFrame(&#123;<span class="string">&#x27;level&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber1&#x27;</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan]&#125;)</span><br><span class="line">data4=pd.DataFrame(&#123;<span class="string">&#x27;level&#x27;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],</span><br><span class="line">                 <span class="string">&#x27;numeber2&#x27;</span>:[<span class="number">2</span>,np.nan,<span class="number">6</span>,<span class="number">10</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;combine: \n&quot;</span>,data3.combine_first(data4),<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure>
<img data-src="https://s1.ax1x.com/2018/10/20/i0T8De.jpg" alt="i0T8De.jpg" />
<figcaption aria-hidden="true">i0T8De.jpg</figcaption>
</figure></li>
</ul>
</div>
<script src="https://giscus.app/client.js"
        data-repo="thinkwee/thinkwee.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnk3OTYxNjMwOA=="
        data-category="Announcements"
        data-category-id="DIC_kwDOBL7ZNM4CkozI"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/machine-learning/" rel="tag"># machine learning</a>
              <a href="/tags/code/" rel="tag"># code</a>
              <a href="/tags/math/" rel="tag"># math</a>
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/01/22/LinearAlgebra3/" rel="prev" title="Note for Linear Algebra 3">
                  <i class="fa fa-angle-left"></i> Note for Linear Algebra 3
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/02/07/TitanicLinearRegression/" rel="next" title="ML Basic Practices">
                  ML Basic Practices <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ICP/IP地址/域名信息备案管理系统 </a>
      <img src="http://www.beian.gov.cn/img/new/gongan.png" alt=""><a href="https://beian.mps.gov.cn/#/query/webSearch?code=%E4%BA%ACICP%E5%A4%872023015408%E5%8F%B7" rel="noopener" target="_blank">京ICP备2023015408号 </a>
  </div>
  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Thinkwee</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">1.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">17:04</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/thinkwee" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>





  <script src="/js/third-party/addtoany.js"></script>

  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"g58NgfMJBlwTyftr6hizdozq-gzGzoHsz","app_key":"1nA1tNVxeeSlAumHogP0PvSd","server_url":"https://leancloud.cn","security":false}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":false,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://thinkwee.top/2017/02/04/pandas-skill/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
